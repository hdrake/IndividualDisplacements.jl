<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>User Guide · IndividualDisplacements</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">IndividualDisplacements</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>User Guide</a><ul class="internal"><li><a class="tocitem" href="#Typical-Workflow"><span>Typical Workflow</span></a></li><li><a class="tocitem" href="#Scope-And-Examples"><span>Scope And Examples</span></a></li><li><a class="tocitem" href="#Data-Structures"><span>Data Structures</span></a></li><li><a class="tocitem" href="#Main-Functions"><span>Main Functions</span></a></li></ul></li><li><a class="tocitem" href="../API/">Tool Box</a></li><li><a class="tocitem" href="../examples/">Example Guide</a></li><li><span class="tocitem">Tutorial Examples</span><ul><li><a class="tocitem" href="../basics/random_flow_field/">Two Dimensions</a></li><li><a class="tocitem" href="../basics/solid_body_rotation/">Three Dimensions</a></li></ul></li><li><span class="tocitem">Real Ocean Cases</span><ul><li><a class="tocitem" href="../worldwide/global_ocean_circulation/">Global Climatology</a></li><li><a class="tocitem" href="../worldwide/three_dimensional_ocean/">Three Dimensions</a></li></ul></li><li><span class="tocitem">MITgcm Examples</span><ul><li><a class="tocitem" href="../basics/detailed_look/">Detailed Look</a></li><li><a class="tocitem" href="../basics/particle_cloud/">Particle Cloud</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>User Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>User Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/master/docs/src/workflow.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Typical-Workflow"><a class="docs-heading-anchor" href="#Typical-Workflow">Typical Workflow</a><a id="Typical-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Typical-Workflow" title="Permalink"></a></h2><p>As documented in the <strong>examples</strong>, the typical worflow is:</p><ol><li>set up <code>FlowFields</code> data structure</li><li>set up <code>Individuals</code> with initial position <code>📌</code></li><li>displace <code>Individuals</code> according to <code>FlowFields</code> (via	<code>∫!</code> and <code>🚄</code>)</li><li>post-process and record results (via <code>🔧</code> and <code>🔴</code>)</li><li>go back to <code>step 2</code> and continue if needed</li></ol><p>Steps <code>1</code> and <code>2</code> are done via data structures documented below. Both steps <code>3</code> and step <code>4</code> often take place within the call to <code>∫!</code>which can readily post-process results via 🔧 before recording them in 🔴 and finally updating positions 📌. Since 🔴 is in the <a href="https://juliadata.github.io/DataFrames.jl/latest/">DataFrames</a> tabular format, it is easily manipulated, plotted, or saved after the fact (step <code>4</code> per se).</p><h2 id="Scope-And-Examples"><a class="docs-heading-anchor" href="#Scope-And-Examples">Scope And Examples</a><a id="Scope-And-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Scope-And-Examples" title="Permalink"></a></h2><p>A central goal of this package is to support scientific analysis of climate model output and observed drifts of e.g. plastics in the Ocean or chemical coumpounds in the Atmosphere.  As an initial step, the package supports all types of gridded model output (on Arakawa C-grids) from the <a href="https://mitgcm.readthedocs.io/en/latest/?badge=latest">MIT General Circulation Model</a> via the <a href="https://github.com/JuliaClimate/MeshArrays.jl">MeshArrays.jl</a> package (<a href="https://juliaclimate.github.io/MeshArrays.jl/dev/">docs found here</a>). </p><p>By convention, <code>IndividualDisplacements.jl</code> expects input flow fields to be provided in a uniform fashion: (1) normalized to grid index units (i.e. in 1/s rather than m/s units); (2) positive towards increasing indices; (3) using the Arakawa C-grid, with <code>u</code> (resp <code>v</code>) staggered by <code>-0.5</code> point in direction <code>1</code> (resp <code>2</code>) from grid cell centers. </p><p><strong>The examples</strong> document simple methods to prepare and ingest such flow fields (time varying or not; in 2D or 3D) and derive individual displacements / trajectories from them. They cover simple grids often used in process studies, Global Ocean simulations normally done on more complex grids, plotting tools, and data formats. </p><p>For an overview of the examples, please refer to the <strong>example guide</strong>. The rest of this section is focused on the package&#39;s <strong>data structures</strong> and <strong>core functions</strong>.</p><h2 id="Data-Structures"><a class="docs-heading-anchor" href="#Data-Structures">Data Structures</a><a id="Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structures" title="Permalink"></a></h2><p>The <code>Individuals</code> struct contains a <code>FlowFields</code> struct (incl. e.g. arrays), initial positions for the individuals, and the other elements (e.g. functions) involved in <code>∫!(𝐼,𝑇)</code> as documented hereafter.</p><article class="docstring"><header><a class="docstring-binding" id="IndividualDisplacements.FlowFields" href="#IndividualDisplacements.FlowFields"><code>IndividualDisplacements.FlowFields</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type FlowFields</code></pre><p>Data structure that provide access to flow fields (gridded as arrays) which will be  used to interpolate velocities to individual locations later on (once embedded in an <code>Individuals</code> struct). </p><p>Following the C-grid convention also used in <code>MITgcm</code> (https://mitgcm.readthedocs.io)  flow fields are expected to be staggered as follows: grid cell i,j has its center located at i-1/2,j-1/2 while the corresponding <code>u[i,j]</code> (resp. `v[i,j]) is located at i-1,j-1/2 (resp. i-1/2,j-1). </p><p>Also by convention, velocity fields are expected to have been normalized to grid units (e.g. 1/s rather than m/s) before sending them to one of the supported <code>FlowFields</code> constructors (using either <code>Array</code> or <code>MeshArray</code>):</p><pre><code class="language-none">𝐹_Array2D (u0,u1,v0,v1,𝑇)
𝐹_Array3D (u0,u1,v0,v1,w0,w1,𝑇)
𝐹_MeshArray2D (u0,u1,v0,v1,𝑇,update_location!)
𝐹_MeshArray3D (u0,u1,v0,v1,w0,w1,𝑇,update_location!)</code></pre><p>For example, constructor calls may look like</p><pre><code class="language-none">𝐹=𝐹_Array3D{eltype(u)}(u,u,v,v,0*w,1*w,[0.0,10.0])
or
𝐹=𝐹_MeshArray2D{eltype(u)}(u,u,v,v,[0.0,10.0],func)</code></pre><p>as shown in the online documentation examples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/2d986b3eb3e0dfa7959943151c484c4b97514a20/src/API.jl#L4-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IndividualDisplacements.Individuals" href="#IndividualDisplacements.Individuals"><code>IndividualDisplacements.Individuals</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct Individuals{T,N}</code></pre><ul><li>Data:           📌 (position),   🔴(record), 🆔 (ID), 𝑃 (<code>FlowFields</code>)</li><li>Functions:      🚄 (velocity),   ∫ (integration), 🔧(postprocessing)</li><li>NamedTuples:    𝐷 (diagnostics),      𝑀 (metadata)</li></ul><p>The velocity function 🚄 typically computes velocity at individual positions (📌 to start) within the  specified space-time domain by interpolating gridded variables (provided via 𝑃). Individual trajectories  are computed by integrating (∫) interpolated velocities through time. Normally, integration is done by  calling ∫! which updates 📌 at the end and records results in 🔴 via 🔧. Unicode cheatsheet:</p><ul><li>📌=<code>\:pushpin:&lt;tab&gt;</code>,          🔴=<code>\:red_circle:&lt;tab&gt;</code>, 🆔=<code>\:id:&lt;tab&gt;</code></li><li>🚄=<code>\:bullettrain_side:&lt;tab&gt;</code>, ∫=<code>\int&lt;tab&gt;</code>,          🔧=<code>\:wrench:&lt;tab&gt;</code></li><li>𝑃=<code>\itP&lt;tab&gt;</code>,                 𝐷=<code>\itD&lt;tab&gt;</code>,           𝑀=<code>\itM&lt;tab&gt;</code></li></ul><p>Simple constructors that use <code>FlowFields</code> to choose adequate defaults:</p><ul><li>Individuals(𝐹::𝐹_Array2D,x,y)</li><li>Individuals(𝐹::𝐹_Array3D,x,y,z)</li><li>Individuals(𝐹::𝐹_MeshArray2D,x,y,fid)</li><li>Individuals(𝐹::𝐹_MeshArray3D,x,y,z,fid)</li></ul><p>Further customization is achievable via keyword constructors:</p><pre><code class="language-none">df=DataFrame( ID=[], x=[], y=[], z=[], t = [])
𝐼=Individuals{Float64,2}(📌=zeros(3,10),🆔=1:10,🔴=deepcopy(df))
𝐼=Individuals(📌=zeros(3,2),🆔=collect(1:2),🔴=deepcopy(df))</code></pre><p>Or via the plain text (or no-unicode) constructors:</p><pre><code class="language-none">df=DataFrame( ID=[], x=[], y=[], z=[], t = [])
I=(position=zeros(3,2),ID=1:2,record=deepcopy(df))
I=Individuals(I)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/base/#L0-L38">source</a></section></article><h2 id="Main-Functions"><a class="docs-heading-anchor" href="#Main-Functions">Main Functions</a><a id="Main-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Functions" title="Permalink"></a></h2><p><code>∫!(𝐼,𝑇)</code> displaces individuals 𝐼 continuously over time period 𝑇 according to velocity function 🚄, temporal integration method ∫, and post-processor 🔧 (all embedded within 𝐼).</p><article class="docstring"><header><a class="docstring-binding" id="IndividualDisplacements.∫!" href="#IndividualDisplacements.∫!"><code>IndividualDisplacements.∫!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">∫!(𝐼::Individuals,𝑇::Tuple)</code></pre><p>Displace simulated individuals continuously through space over time period 𝑇 starting from position 📌. </p><ul><li>This is typically achieved by computing the cumulative integral of velocity experienced by each individual along its trajectory (∫ 🚄 dt).</li><li>The current default is <code>solve(prob,Tsit5(),reltol=1e-8,abstol=1e-8)</code> but all solver options from the <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> package are available.</li><li>After this, <code>∫!</code> is also equipped to postprocess results recorded into 🔴 via the 🔧 workflow, and the last step in <code>∫!</code> consists in updating 📌 to be ready for continuing in a subsequent call to <code>∫!</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/2d986b3eb3e0dfa7959943151c484c4b97514a20/src/API.jl#L216-L224">source</a></section><section><div><pre><code class="language-none">∫!(𝐼::Individuals)</code></pre><p>Call ∫!(𝐼::Individuals,𝐼.𝑃.𝑇)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/2d986b3eb3e0dfa7959943151c484c4b97514a20/src/API.jl#L241-L245">source</a></section></article><p>The velocity interpolation functions (🚄) carry out the central computation of this package – interpolating gridded flow fields to individual positions 📌. It is normally called via <code>∫!</code> to integrate velocity 🚄 over a chosen time period. </p><ul><li>Velocity interpolation for several array and grid types.</li><li>Preprocessing and postprocessing methods.</li><li>I/O routines to read (write) results from (to) file.</li></ul><p>and other functionalities provided in <code>src/compute.jl</code> and <code>src/data_wrangling.jl</code> are further documented in the <em>Tool Box</em> section. Ingestion of trajectory data which have been collected by the <a href="https://doi.org/10.1002/2016JC011716">Ocean Drifting Buoy Program</a> (<a href="https://youtu.be/82HPnYBtoVo">movie</a>) is also supported.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../API/">Tool Box »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 8 February 2021 02:04">Monday 8 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
